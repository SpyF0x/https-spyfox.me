<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><meta http-equiv=x-ua-compatible content="IE=edge, chrome=1"><title>The black magic behind denial of service attacks - ~# SpyF0x_</title><meta name=Description content="Alternative title : Why you can't un-hack a compromised machine"><meta property="og:title" content="The black magic behind denial of service attacks"><meta property="og:description" content="Alternative title : Why you can't un-hack a compromised machine"><meta property="og:type" content="article"><meta property="og:url" content="https://spyfox.me/posts/cybersecurity/offensive/network/the-black-magic-behind-denial-of-service-attacks/"><meta property="og:image" content="https://spyfox.me/logo.png"><meta property="article:published_time" content="2021-10-10T14:00:00+00:00"><meta property="article:modified_time" content="2021-10-10T14:00:00+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://spyfox.me/logo.png"><meta name=twitter:title content="The black magic behind denial of service attacks"><meta name=twitter:description content="Alternative title : Why you can't un-hack a compromised machine"><meta name=application-name content="~# SpyF0x_"><meta name=apple-mobile-web-app-title content="~# SpyF0x_"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://spyfox.me/posts/cybersecurity/offensive/network/the-black-magic-behind-denial-of-service-attacks/><link rel=prev href=https://spyfox.me/posts/system/browser/how-to-enable-encrypted-dns-dns-over-https-in-firefox/><link rel=next href=https://spyfox.me/posts/cybersecurity/offensive/web/web-pentesting-fundamentals/><link rel=stylesheet href=/lib/normalize/normalize.min.css><link rel=stylesheet href=/css/style.min.css><link rel=stylesheet href=/lib/fontawesome-free/all.min.css><link rel=stylesheet href=/lib/animate/animate.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"The black magic behind denial of service attacks","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/spyfox.me\/posts\/cybersecurity\/offensive\/network\/the-black-magic-behind-denial-of-service-attacks\/"},"image":["https:\/\/spyfox.me\/images\/Apple-Devices-Preview.png"],"genre":"posts","keywords":"ddos, dos, cyberattack, denial of service","wordcount":1114,"url":"https:\/\/spyfox.me\/posts\/cybersecurity\/offensive\/network\/the-black-magic-behind-denial-of-service-attacks\/","datePublished":"2021-10-10T14:00:00+00:00","dateModified":"2021-10-10T14:00:00+00:00","publisher":{"@type":"Organization","name":"SpyF0x","logo":"https:\/\/spyfox.me\/images\/avatar.png"},"author":{"@type":"Person","name":" SpyF0x "},"description":"Alternative title : Why you can't un-hack a compromised machine"}</script></head><body header-desktop=fixed header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem('theme')?localStorage.getItem('theme')==='dark':'auto'==='auto'?window.matchMedia('(prefers-color-scheme: dark)').matches:'auto'==='dark')&&document.body.setAttribute('theme','dark')</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="~# SpyF0x_"><img class="lazyload logo" src=/svg/loading.min.svg data-src=/images/avatar.png data-srcset="/images/avatar.png, /images/avatar.png 1.5x, /images/avatar.png 2x" data-sizes=auto alt=/images/avatar.png title=/images/avatar.png>~# SpyF0x_</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>Posts </a><a class=menu-item href=/tags/>Tags </a><a class=menu-item href=/categories/>Categories </a><a class=menu-item href=/posts/about>About </a><a class=menu-item href=/posts/contact><i class="far fa-envelope fa-fw"></i> </a><a class=menu-item href=/index.xml><i class="fas fa-rss fa-fw"></i> </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder="Search titles or contents..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=Search><i class="fas fa-search fa-fw"></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Clear><i class="fas fa-times-circle fa-fw"></i></a>
<span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin"></i></span>
</span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw"></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="~# SpyF0x_"><img class="lazyload logo" src=/svg/loading.min.svg data-src=/images/avatar.png data-srcset="/images/avatar.png, /images/avatar.png 1.5x, /images/avatar.png 2x" data-sizes=auto alt=/images/avatar.png title=/images/avatar.png>~# SpyF0x_</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="Search titles or contents..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=Search><i class="fas fa-search fa-fw"></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Clear><i class="fas fa-times-circle fa-fw"></i></a>
<span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin"></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>Cancel</a></div><a class=menu-item href=/posts/ title>Posts</a><a class=menu-item href=/tags/ title>Tags</a><a class=menu-item href=/categories/ title>Categories</a><a class=menu-item href=/posts/about title>About</a><a class=menu-item href=/posts/contact title><i class="far fa-envelope fa-fw"></i></a><a class=menu-item href=/index.xml title><i class="fas fa-rss fa-fw"></i></a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw"></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animated flipInX">The black magic behind denial of service attacks</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=/ title=Author rel=" author" class=author><i class="fas fa-user-circle fa-fw"></i> SpyF0x </a></span>&nbsp;<span class=post-category>included in <a href=/categories/offensive-security/><i class="far fa-folder fa-fw"></i>Offensive Security</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime=2021-10-10>2021-10-10</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;1114 words&nbsp;
<i class="far fa-clock fa-fw"></i>&nbsp;6 minutes&nbsp;</div></div><div class=featured-image><img class=lazyload src=/svg/loading.min.svg data-src=/images/security/denial-of-service/black%20magic%20behind%20denial%20of%20service%20attacks.webp data-srcset="/images/security/denial-of-service/black%20magic%20behind%20denial%20of%20service%20attacks.webp, /images/security/denial-of-service/black%20magic%20behind%20denial%20of%20service%20attacks.webp 1.5x, /images/security/denial-of-service/black%20magic%20behind%20denial%20of%20service%20attacks.webp 2x" data-sizes=auto alt="/images/security/denial-of-service/black magic behind denial of service attacks.webp" title="Alternative title : Why you can't un-hack a compromised machine"></div><div class="details toc" id=toc-static kept><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right"></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#a-little-bit-of-context>A little bit of context</a></li><li><a href=#why-conduct-a-denial-of-service-attack>Why conduct a denial of service attack</a><ul><li><a href=#to-protest>To protest</a></li><li><a href=#diverting-attention>Diverting attention</a></li><li><a href=#social-engineering>Social engineering</a></li><li><a href=#information-leakage>Information leakage</a></li></ul></li><li><a href=#attacks-methodologies>Attacks methodologies</a><ul><li><a href=#icmp-flood>ICMP Flood</a></li><li><a href=#syn-flood>SYN Flood</a></li><li><a href=#udp-flood>UDP Flood</a></li><li><a href=#amplification-attacks>Amplification attacks</a></li><li><a href=#exploiting-the-limits-of-the-machines>Exploiting the limits of the machines</a></li></ul></li><li><a href=#distributed-attacks>Distributed attacks</a></li><li><a href=#dyn-ddos>Dyn DDoS</a></li><li><a href=#make-a-good-action->Make a good action !</a></li></ul></nav></div></div><div class=content id=content><p>A denial of service attack is when an application (or anything else) is prevented from doing what it was designed to do.</p><h2 id=a-little-bit-of-context>A little bit of context</h2><hr><p>Denial of service (or DoS) attacks are back in the news every year. Whether it&rsquo;s with the breakdown of Xbox live, Playstation Network or Steam servers, the goal is always the same:</p><p>to prevent an application or a server from doing its job.</p><p>There are basically two types of denial of service attacks :</p><ul><li>Low-traffic attacks</li><li>High-traffic attacks</li></ul><p>But before detailing the techniques that can be used by hackers to achieve their needs. One may wonder why they do these attacks and annoy so many people.</p><h2 id=why-conduct-a-denial-of-service-attack>Why conduct a denial of service attack</h2><h3 id=to-protest>To protest</h3><p>Anonymous and other hacktivist groups use denial of service attacks to paralyze a website, just as one would protest in the street.</p><figure><img src=/images/security/denial-of-service/anonymous_ddos.jpg alt="denial of service attack"></figure><p>A website can be inaccessible for a few minutes / hours / days. It all depends on the duration of the attack.</p><p>It has been the case with Lulzsec taking down MasterCard and VISA websites to protest to the increasing pressure of the governments to control the Internet.</p><h3 id=diverting-attention>Diverting attention</h3><p>Hackers can also use this type of attack, which is very visible, to divert the attention of the security experts of the company they are attacking.</p><p>In parallel, they will execute one or more, other quieter attacks to break into the company&rsquo;s network.</p><figure><img src=/images/security/denial-of-service/denial-of-service1.webp alt="denial of service attack"></figure><h3 id=social-engineering>Social engineering</h3><p>A hacker may also want to stop an application after introducing himself to the employees as the person to contact in case of malfunction.</p><p>The employees will then trust the hacker and be inclined to give him confidential information.</p><h3 id=information-leakage>Information leakage</h3><p>Generally, when an application stops working, the persons in charge will try to restart it.</p><p>During this restart stage, information that would normally be inaccessible could be visible :</p><figure><img src=/images/security/denial-of-service/denial-of-service2.webp alt="denial of service attack"></figure><ul><li>File list</li><li>Identifiers</li><li>Computer names</li><li>etc.</li></ul><p>This information leakage can also occur if a hacker manages to stop a part of a server without altering the whole.</p><p>For example, TLS encryption can be stopped to intercept information in plain text, or an SSH server can be stopped to force administrators to connect using an unencrypted telnet connection.</p><h2 id=attacks-methodologies>Attacks methodologies</h2><h3 id=icmp-flood>ICMP Flood</h3><p>It&rsquo;s one of the oldest attacks. The attacker saturates the target with ICMP echo requests (a kind of ping) or other types, which allows to bring down the victim&rsquo;s network infrastructure.</p><figure><img src=/images/security/denial-of-service/ICMP-flood-attack.png alt="denial of service attack"></figure><h3 id=syn-flood>SYN Flood</h3><p>Is another classic. It consists in initiating TCP connections to the server with a SYN message. The server takes this message into account and replies to the client with the SYN-ACK message.</p><p>The client must then respond with a new ACK message to tell the server that the connection is successfully established.</p><figure><img src=/images/security/denial-of-service/SYN-flood-attack.png alt="denial of service attack"></figure><p>However, in the case of a SYN attack, the client does not respond and the server keeps the connection open.</p><p>By multiplying this kind of SYN messages it is possible to paralyze the server.</p><h3 id=udp-flood>UDP Flood</h3><p>It consists in sending a large number of UDP packets to random ports of the target machine.</p><figure><img src=/images/security/denial-of-service/UDP-flood-attack.png alt="denial of service attack"></figure><p>The latter then indicates with an ICMP message that no application is responding on this port.</p><p>If the quantity of UDP packets sent by the attacker is significant, the number of ICMP messages sent back by the victim will also be significant, saturating the resources of the machine.</p><h3 id=amplification-attacks>Amplification attacks</h3><p>Amplification attacks involve spoofing the victim&rsquo;s IP address to send small queries to a server but receiving a much larger response from it.</p><figure><img src=/images/security/denial-of-service/amplification-ddos-attacks.jpg alt="denial of service attack"></figure><p>A botnet can then greatly amplify the size of an attack by relying on existing legitimate infrastructure such as DNS or NTP servers.</p><p>Here is a small summary table showing the protocols offering the most amplification :</p><figure><img src=/images/security/denial-of-service/amplification-ddos-attack.webp alt="denial of service attack"></figure><h3 id=exploiting-the-limits-of-the-machines>Exploiting the limits of the machines</h3><p>There are a plethora of possibilities to make a denial of service attack. Any loophole can be used.</p><p>You have certainly already seen this type of message :</p><figure><img src=/images/security/denial-of-service/win_ddos.png alt="denial of service attack"></figure><p>A DoS attack consists in obtaining the same result remotely. All means are good:</p><ul><li>Buffer overflow</li><li>Fills the disk space</li><li>Consume all available memory or CPU time</li><li>etc.</li></ul><p>One of the best known examples of application layer attack is Slowloris, a tool developed by RSnake (Robert Hansen) that keeps connections open on the target server by sending a partial request. These accumulated unclosed connections completely saturate the server in several minutes.</p><p>Apart from Slowloris, tools such as Low Orbit Ion Cannon (LOIC), High Orbit Ion Canon (HOIC), R.U. Dead Yet? (RUDY), #RefRef or hping also allow, without much knowledge, to perform DoS attacks without having to use huge botnets.</p><p>For example, #RefRef exploits a vulnerability present in SQL databases, and thanks to an SQL injection of a few lines, is capable of triggering an effective denial of service.</p><figure><img src=/images/security/denial-of-service/refref-dos.jpg alt="denial of service attack"></figure><h2 id=distributed-attacks>Distributed attacks</h2><p>DDoS (Distributed Denial of Service) is a denial of service attack which, as its name indicates, is distributed.</p><p>This means that several tens / hundreds / thousands of computers, grouped in what is called a &ldquo;botnet&rdquo;, will simultaneously attack a website, relying on the number of connections to make the application inaccessible.</p><p>Here is a real life example :</p><p><figure><img src=/images/security/denial-of-service/china_traffic_jam_ddos.jpg alt="denial of service attack"></figure><em>China National Highway 110 traffic jam</em></p><p>To properly operate the botnet, a hacker would need a command and control server (C&C or C2).</p><p>It is basically the keystone of the whole infrastructure. It is to this central server that the botnet obeys. If this server disappears, it is the entire botnet wich disappear.</p><figure><img src=/images/security/denial-of-service/botnet_ddos.png alt="denial of service attack"></figure><h2 id=dyn-ddos>Dyn DDoS</h2><p>On October 2016, Dyn fell victim to a massive DDoS attack of more than a Terabyte per second (the equivalent of 220 bluray per seconds).</p><p>Many websites using the Dyn Managed DNS service (different from DynDNS), such as Twitter, Spotify, Soundcloud, Reddit, Ebay, Netflix, GitHub, PayPal, are inaccessible for about ten hours.</p><p>It has been mentioned that the attackers used hacked connected objects (such as surveillance cameras) to relay the massive flow.</p><figure><img src=/images/security/denial-of-service/dyn_ddos.png alt="denial of service attack"></figure><p>Note that in November 2016, as a direct consequence of the attack, Dyn was acquired by Oracle for an undisclosed amount.</p><p>Of course, no one is immune to a DDoS attack.</p><p>Fortunately, there are technical solutions that can detect and reduce the impact of a high-traffic attack but only backups and redundancy would help against low-traffic attacks.</p><p>To get a better idea of how common these attacks are, digitalattackmap.com has an animated map.</p><p>You can see the nature, origin and destination of such attacks that are taking place as you read this.</p><h2 id=make-a-good-action->Make a good action !</h2><hr><p>Hit that <code>CTRL + D</code> to bookmark this website 🔖</p><p>Internet is for sharing, so please consider sharing this post if you liked it !</p><p>It will be so much better than any newsletter #privacy #spam #planet 🌍 ❤️</p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 2021-10-10</span></div><div class=post-info-license></div></div><div class=post-info-line><div class=post-info-md><span><a class=link-to-markdown href=/posts/cybersecurity/offensive/network/the-black-magic-behind-denial-of-service-attacks/index.md target=_blank>Read Markdown</a></span></div><div class=post-info-share><span><a href=javascript:void(0); title="Share on Twitter" data-sharer=twitter data-url=https://spyfox.me/posts/cybersecurity/offensive/network/the-black-magic-behind-denial-of-service-attacks/ data-title="The black magic behind denial of service attacks" data-hashtags="ddos,dos,cyberattack,denial of service"><i class="fab fa-twitter fa-fw"></i></a><a href=javascript:void(0); title="Share on Facebook" data-sharer=facebook data-url=https://spyfox.me/posts/cybersecurity/offensive/network/the-black-magic-behind-denial-of-service-attacks/ data-hashtag=ddos><i class="fab fa-facebook-square fa-fw"></i></a><a href=javascript:void(0); title="Share on Linkedin" data-sharer=linkedin data-url=https://spyfox.me/posts/cybersecurity/offensive/network/the-black-magic-behind-denial-of-service-attacks/><i class="fab fa-linkedin fa-fw"></i></a><a href=javascript:void(0); title="Share on Reddit" data-sharer=reddit data-url=https://spyfox.me/posts/cybersecurity/offensive/network/the-black-magic-behind-denial-of-service-attacks/><i class="fab fa-reddit fa-fw"></i></a><a href=javascript:void(0); title="Share on VK" data-sharer=vk data-url=https://spyfox.me/posts/cybersecurity/offensive/network/the-black-magic-behind-denial-of-service-attacks/ data-title="The black magic behind denial of service attacks" data-caption="Alternative title : Why you can't un-hack a compromised machine" data-image="/images/security/denial-of-service/black magic behind denial of service attacks.webp"><i class="fab fa-vk fa-fw"></i></a><a href=javascript:void(0); title="Share on Pocket" data-sharer=pocket data-url=https://spyfox.me/posts/cybersecurity/offensive/network/the-black-magic-behind-denial-of-service-attacks/><i class="fab fa-get-pocket fa-fw"></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw"></i>&nbsp;<a href=/tags/ddos/>ddos</a>,&nbsp;<a href=/tags/dos/>dos</a>,&nbsp;<a href=/tags/cyberattack/>cyberattack</a>,&nbsp;<a href=/tags/denial-of-service/>denial of service</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class=post-nav><a href=/posts/system/browser/how-to-enable-encrypted-dns-dns-over-https-in-firefox/ class=prev rel=prev title="How to enable encrypted DNS (DNS-over-HTTPS) in Firefox"><i class="fas fa-angle-left fa-fw"></i>How to enable encrypted DNS (DNS-over-HTTPS) in Firefox</a>
<a href=/posts/cybersecurity/offensive/web/web-pentesting-fundamentals/ class=next rel=next title="Web pentesting - Fundamentals">Web pentesting - Fundamentals<i class="fas fa-angle-right fa-fw"></i></a></div></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line><i class="far fa-copyright fa-fw"></i><span itemprop=copyrightYear>2019 - 2022</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/ target=_blank> SpyF0x </a></span>&nbsp;|&nbsp;<span class=license><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc-nd/4.0/ target=_blank>CC BY-NC-ND 4.0</a></span><span class=icp-splitter>&nbsp;|&nbsp;</span><br class=icp-br><span class=icp><a href=/posts/disclaimer>Disclaimer</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw"></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw"></i></a></div><script type=text/javascript src=/lib/smooth-scroll/smooth-scroll.min.js></script><script type=text/javascript src=/lib/autocomplete/autocomplete.min.js></script><script type=text/javascript src=/lib/lunr/lunr.min.js></script><script type=text/javascript src=/lib/lazysizes/lazysizes.min.js></script><script type=text/javascript src=/lib/clipboard/clipboard.min.js></script><script type=text/javascript src=/lib/sharer/sharer.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:50},comment:{},search:{highlightTag:"em",lunrIndexURL:"/index.json",maxResultLength:10,noResultsFound:"No results found",snippetLength:30,type:"lunr"}}</script><script type=text/javascript src=/js/theme.min.js></script></body></html>