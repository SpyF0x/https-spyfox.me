<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><meta http-equiv=x-ua-compatible content="IE=edge, chrome=1"><title>XSS - Fundamentals - ~# SpyF0x_</title><meta name=Description content="You have certainly already heard about XSS. But what is really a Cross Site Scripting (XSS), how can a hacker exploit this kind of vulnerability and for what purpose ?"><meta property="og:title" content="XSS - Fundamentals"><meta property="og:description" content="You have certainly already heard about XSS. But what is really a Cross Site Scripting (XSS), how can a hacker exploit this kind of vulnerability and for what purpose ?"><meta property="og:type" content="article"><meta property="og:url" content="https://spyfox.me/posts/cybersecurity/offensive/web/xss-fundamentals/"><meta property="og:image" content="https://spyfox.me/logo.png"><meta property="article:published_time" content="2021-09-28T19:00:00+00:00"><meta property="article:modified_time" content="2021-09-28T19:00:00+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://spyfox.me/logo.png"><meta name=twitter:title content="XSS - Fundamentals"><meta name=twitter:description content="You have certainly already heard about XSS. But what is really a Cross Site Scripting (XSS), how can a hacker exploit this kind of vulnerability and for what purpose ?"><meta name=application-name content="~# SpyF0x_"><meta name=apple-mobile-web-app-title content="~# SpyF0x_"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://spyfox.me/posts/cybersecurity/offensive/web/xss-fundamentals/><link rel=prev href=https://spyfox.me/posts/shame/freenom-free-domains-is-it-worth-it-/><link rel=next href=https://spyfox.me/posts/system/how-to-choose-dns-servers-1.1.1.1-8.8.8.8-or-9.9.9.9/><link rel=stylesheet href=/lib/normalize/normalize.min.css><link rel=stylesheet href=/css/style.min.css><link rel=stylesheet href=/lib/fontawesome-free/all.min.css><link rel=stylesheet href=/lib/animate/animate.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"XSS - Fundamentals","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/spyfox.me\/posts\/cybersecurity\/offensive\/web\/xss-fundamentals\/"},"image":["https:\/\/spyfox.me\/images\/Apple-Devices-Preview.png"],"genre":"posts","keywords":"compromised, xss, cross site scripting","wordcount":998,"url":"https:\/\/spyfox.me\/posts\/cybersecurity\/offensive\/web\/xss-fundamentals\/","datePublished":"2021-09-28T19:00:00+00:00","dateModified":"2021-09-28T19:00:00+00:00","publisher":{"@type":"Organization","name":"SpyF0x","logo":"https:\/\/spyfox.me\/images\/avatar.png"},"author":{"@type":"Person","name":" SpyF0x "},"description":"You have certainly already heard about XSS. But what is really a Cross Site Scripting (XSS), how can a hacker exploit this kind of vulnerability and for what purpose ?"}</script></head><body header-desktop=fixed header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem('theme')?localStorage.getItem('theme')==='dark':'auto'==='auto'?window.matchMedia('(prefers-color-scheme: dark)').matches:'auto'==='dark')&&document.body.setAttribute('theme','dark')</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="~# SpyF0x_"><img class="lazyload logo" src=/svg/loading.min.svg data-src=/images/avatar.png data-srcset="/images/avatar.png, /images/avatar.png 1.5x, /images/avatar.png 2x" data-sizes=auto alt=/images/avatar.png title=/images/avatar.png>~# SpyF0x_</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>Posts </a><a class=menu-item href=/tags/>Tags </a><a class=menu-item href=/categories/>Categories </a><a class=menu-item href=/posts/about>About </a><a class=menu-item href=/index.xml><i class="fas fa-rss fa-fw"></i> </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder="Search titles or contents..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=Search><i class="fas fa-search fa-fw"></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Clear><i class="fas fa-times-circle fa-fw"></i></a>
<span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin"></i></span>
</span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw"></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="~# SpyF0x_"><img class="lazyload logo" src=/svg/loading.min.svg data-src=/images/avatar.png data-srcset="/images/avatar.png, /images/avatar.png 1.5x, /images/avatar.png 2x" data-sizes=auto alt=/images/avatar.png title=/images/avatar.png>~# SpyF0x_</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="Search titles or contents..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=Search><i class="fas fa-search fa-fw"></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Clear><i class="fas fa-times-circle fa-fw"></i></a>
<span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin"></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>Cancel</a></div><a class=menu-item href=/posts/ title>Posts</a><a class=menu-item href=/tags/ title>Tags</a><a class=menu-item href=/categories/ title>Categories</a><a class=menu-item href=/posts/about title>About</a><a class=menu-item href=/index.xml title><i class="fas fa-rss fa-fw"></i></a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw"></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animated flipInX">XSS - Fundamentals</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=/ title=Author rel=" author" class=author><i class="fas fa-user-circle fa-fw"></i> SpyF0x </a></span>&nbsp;<span class=post-category>included in <a href=/categories/offensive-security/><i class="far fa-folder fa-fw"></i>Offensive Security</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime=2021-09-28>2021-09-28</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;998 words&nbsp;
<i class="far fa-clock fa-fw"></i>&nbsp;5 minutes&nbsp;</div></div><div class=featured-image><img class=lazyload src=/svg/loading.min.svg data-src=/images/security/xss-fundamentals/xss-fundamentals.png data-srcset="/images/security/xss-fundamentals/xss-fundamentals.png, /images/security/xss-fundamentals/xss-fundamentals.png 1.5x, /images/security/xss-fundamentals/xss-fundamentals.png 2x" data-sizes=auto alt=/images/security/xss-fundamentals/xss-fundamentals.png title="You have certainly already heard about XSS. But what is really a Cross Site Scripting (XSS), how can a hacker exploit this kind of vulnerability and for what purpose ?"></div><div class="details toc" id=toc-static kept><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right"></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#a-little-bit-of-context>A little bit of context</a></li><li><a href=#what-are-the-risks>What are the risks?</a><ul><li><a href=#concretely-a-hacker-would-be-able-to->Concretely, a hacker would be able to :</a></li></ul></li><li><a href=#reflected-xss>Reflected XSS</a></li><li><a href=#stored-xss>Stored XSS</a></li><li><a href=#attacking-a-server-using-an-xss-vulnerability>Attacking a server using an XSS vulnerability</a><ul><li><a href=#methodology->Methodology :</a></li></ul></li><li><a href=#how-to-prevent-xss->How to prevent XSS ?</a></li><li><a href=#make-a-good-action->Make a good action !</a></li></ul></nav></div></div><div class=content id=content><p>You have certainly already heard about XSS. But what is really a Cross Site Scripting (XSS), how can a hacker exploit this kind of vulnerability and for what purpose ?</p><h2 id=a-little-bit-of-context>A little bit of context</h2><hr><p>We regularly hear about Cross Site Scripting. Depending on your level, you know that it is either has something to do with JavaScript or, if you are keen on computer security, you could even state that XSS is a security flaw allowing a user of the site to inject JavaScript code into a web page.</p><p>Concretely, if you post something like :</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback>&lt;script&gt;alert(&#39;XSS&#39;);&lt;/script&gt;
</code></pre></td></tr></table></div></div><p>in a forum and when your comment is displayed, you see a pop-up containing &ldquo;XSS&rdquo;, congratulations, you have just spoted an XSS.</p><h2 id=what-are-the-risks>What are the risks?</h2><p>You might think that inserting an alert message isn&rsquo;t terribly dangerous, but if you can inject that, you can inject other scripts that are more malicious. It is not necessary to be able to inject any particular special character in order to attack. If you can inject alert(1) then you can inject any arbitrary script using JS.</p><p>Friends administrators, don&rsquo;t worry. This kind of vulnerability cannot be exploited to gain access to your server (though, we&rsquo;ll see about that later). The targets of hackers who exploit this kind of vulnerability are the users of your app / website.</p><p>JavaScript is executed on the client side. It is therefore not possible to execute a script directly on the server using only XSS.</p><h3 id=concretely-a-hacker-would-be-able-to->Concretely, a hacker would be able to :</h3><ul><li>Redecorate with some defacement.</li><li>Use your account if you are authenticated to post messages or perform any other action that you could normally do.</li><li>Redirect you to an authentication page that looks exactly like the authentication page of the site you were on, in order to steal your credentials.</li><li>Spread a malicious source code to all your contacts if the flaw exists on a social network.</li><li>Use your computer to launch DDoS attack or mine some bitcoins</li></ul><p>In short, anything that can be done with JavaScript&mldr;</p><h2 id=reflected-xss>Reflected XSS</h2><p>In a reflected XSS attack, the attack is in the request itself (frequently the URL) and the vulnerability occurs when the server inserts the attack in the response. The victim triggers the attack by browsing to a malicious URL created by the attacker</p><p><code>http://www.acme[.]com/?title=&lt;SCRIPT>document.location='http://evil[.]com/'&lt;/SCRIPT></code></p><p>For instance, accessing this URL will simply redirect to the site http://evil[.]com which may for example launch a Java applet exploiting a bug to install a virus on your computer, before redirecting you back to the legitimate site http://acme[.]com.</p><p><figure><img src=/images/security/xss-fundamentals/xss-fundamentals3.png alt="a cool image"></figure><em>A example on an insecured webapp vulnerable to URL parameter</em></p><h2 id=stored-xss>Stored XSS</h2><p>In a stored XSS attack, the attacker stores the attack in the application (e.g., in a snippet) and the victim triggers the attack by browsing to a page on the server that renders the attack, by not properly escaping or sanitizing the stored data.</p><p>Note that the victim does not even need to explicitly click on the malicious link. Suppose the attacker owns evil[.]com, and creates a page with an invisible <code>&lt;img></code> or <code>&lt;iframe></code> pointing to the malicious link; if the victim visits evil[.]com, the attack will silently be activated.</p><p><figure><img src=/images/security/xss-fundamentals/xss-fundamentals5.jpg alt="a cool image"></figure><em>The vast majority of website defacements are made by XSS</em></p><h2 id=attacking-a-server-using-an-xss-vulnerability>Attacking a server using an XSS vulnerability</h2><p>What a catchy title!</p><p>Many of you could tell me that it is impossible&mldr; Of course, it is not possible to use an XSS flaw to directly hack a server.
But nothing is impossible in hacking, you just have to get around the obstacles. Let&rsquo;s imagine a scenario to achieve that!</p><p>What we know about our target :</p><ul><li>There is a management interface using a session on the server.</li><li>The session identifier is kept in the cookies.</li><li>And of course, there&rsquo;s an XSS</li></ul><p>The goal of this attack is to do a classic session-hijacking.</p><figure><img src=/images/security/xss-fundamentals/xss-fundamentals6.png alt="a cool image"></figure><h3 id=methodology->Methodology :</h3><ol><li>We setup a web server (Python SimpleHTTPServer is a good one)</li><li>We create a JavaScript to load an image (or an iframe) from our webserver, and we pass a <code>document.cookie</code> into the URL call.</li><li>We insert this script in the page, and we wait for the administrator to see the page.</li><li>Once the page loaded on the admin side, we get the user cookie through the precedent URL call.</li><li>Once we have forged the cookie on our browser, all we have to do is to connect to the admin account (no need to identify ourselves)!</li><li>If the administrator disconnects, we will also be disconnected, so we must take advantage of this short moment to maintain access.</li></ol><figure><img src=/images/security/xss-fundamentals/xss-fundamentals7.png alt="a cool image"></figure><p>If the management interface allows it, we can take advantage of it to :</p><ul><li>Get the e-mail addresses of all users</li><li>Modify pages of the site to integrate JavaScript code in order to spread the attack</li><li>Infect the server with a virus</li><li>Tamper logs</li><li>Modify pages templates to retrieve server names, database identifiers&mldr;</li><li>Delete user accounts</li><li>Delete pages (delete the site?) / Defacements</li><li>Etc.</li></ul><h2 id=how-to-prevent-xss->How to prevent XSS ?</h2><p>XSS is a difficult beast. On one hand, a fix to an XSS vulnerability is usually trivial and involves applying the correct sanitizing function to user input when it&rsquo;s displayed in a certain context. On the other hand, if history is any indication, this is extremely difficult to get right. US-CERT reports dozens of publicly disclosed XSS vulnerabilities involving so many companies.</p><p>Though there is no magic defense to getting rid of XSS vulnerabilities, here are some steps you should take to prevent these types of bugs from popping up in your products:</p><ul><li>First, make sure you understand the problem.</li><li>Properly use modern JS frameworks (READ THE DOCS !!!)</li><li>Use an Auto-Escaping Template System</li><li>Implement Content Security Policy</li><li>Employ good testing practices with respect to XSS.</li><li>Stay informed :)</li></ul><h2 id=make-a-good-action->Make a good action !</h2><hr><p>Hit that <code>CTRL + D</code> to bookmark this website 🔖</p><p>Internet is for sharing, so please consider sharing this post if you liked it !</p><p>It will be so much better than any newsletter #privacy #spam #planet 🌍 ❤️</p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 2021-09-28</span></div><div class=post-info-license></div></div><div class=post-info-line><div class=post-info-md><span><a class=link-to-markdown href=/posts/cybersecurity/offensive/web/xss-fundamentals/index.md target=_blank>Read Markdown</a></span></div><div class=post-info-share><span><a href=javascript:void(0); title="Share on Twitter" data-sharer=twitter data-url=https://spyfox.me/posts/cybersecurity/offensive/web/xss-fundamentals/ data-title="XSS - Fundamentals" data-hashtags="compromised,xss,cross site scripting"><i class="fab fa-twitter fa-fw"></i></a><a href=javascript:void(0); title="Share on Facebook" data-sharer=facebook data-url=https://spyfox.me/posts/cybersecurity/offensive/web/xss-fundamentals/ data-hashtag=compromised><i class="fab fa-facebook-square fa-fw"></i></a><a href=javascript:void(0); title="Share on Linkedin" data-sharer=linkedin data-url=https://spyfox.me/posts/cybersecurity/offensive/web/xss-fundamentals/><i class="fab fa-linkedin fa-fw"></i></a><a href=javascript:void(0); title="Share on Reddit" data-sharer=reddit data-url=https://spyfox.me/posts/cybersecurity/offensive/web/xss-fundamentals/><i class="fab fa-reddit fa-fw"></i></a><a href=javascript:void(0); title="Share on VK" data-sharer=vk data-url=https://spyfox.me/posts/cybersecurity/offensive/web/xss-fundamentals/ data-title="XSS - Fundamentals" data-caption="You have certainly already heard about XSS. But what is really a Cross Site Scripting (XSS), how can a hacker exploit this kind of vulnerability and for what purpose ?" data-image=/images/security/xss-fundamentals/xss-fundamentals.png><i class="fab fa-vk fa-fw"></i></a><a href=javascript:void(0); title="Share on Pocket" data-sharer=pocket data-url=https://spyfox.me/posts/cybersecurity/offensive/web/xss-fundamentals/><i class="fab fa-get-pocket fa-fw"></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw"></i>&nbsp;<a href=/tags/compromised/>compromised</a>,&nbsp;<a href=/tags/xss/>xss</a>,&nbsp;<a href=/tags/cross-site-scripting/>cross site scripting</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class=post-nav><a href=/posts/shame/freenom-free-domains-is-it-worth-it-/ class=prev rel=prev title="Freenom free domains is it worth it ?"><i class="fas fa-angle-left fa-fw"></i>Freenom free domains is it worth it ?</a>
<a href=/posts/system/how-to-choose-dns-servers-1.1.1.1-8.8.8.8-or-9.9.9.9/ class=next rel=next title="DNS servers : 1.1.1.1, 8.8.8.8 or 9.9.9.9 ?">DNS servers : 1.1.1.1, 8.8.8.8 or 9.9.9.9 ?<i class="fas fa-angle-right fa-fw"></i></a></div></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line><i class="far fa-copyright fa-fw"></i><span itemprop=copyrightYear>2019 - 2022</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/ target=_blank> SpyF0x </a></span>&nbsp;|&nbsp;<span class=license><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc-nd/4.0/ target=_blank>CC BY-NC-ND 4.0</a></span><span class=icp-splitter>&nbsp;|&nbsp;</span><br class=icp-br><span class=icp><a href=/posts/disclaimer>Disclaimer</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw"></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw"></i></a></div><script type=text/javascript src=/lib/smooth-scroll/smooth-scroll.min.js></script><script type=text/javascript src=/lib/autocomplete/autocomplete.min.js></script><script type=text/javascript src=/lib/lunr/lunr.min.js></script><script type=text/javascript src=/lib/lazysizes/lazysizes.min.js></script><script type=text/javascript src=/lib/clipboard/clipboard.min.js></script><script type=text/javascript src=/lib/sharer/sharer.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:50},comment:{},search:{highlightTag:"em",lunrIndexURL:"/index.json",maxResultLength:10,noResultsFound:"No results found",snippetLength:30,type:"lunr"}}</script><script type=text/javascript src=/js/theme.min.js></script></body></html>