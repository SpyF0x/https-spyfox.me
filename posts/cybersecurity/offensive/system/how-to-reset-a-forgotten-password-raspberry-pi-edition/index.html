<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><meta http-equiv=x-ua-compatible content="IE=edge, chrome=1"><title>How to reset a forgotten password (Raspberry Pi edition) - ~# SpyF0x_</title><meta name=Description content="To do that, simply take the sd card out of your Raspberry Pi and put it in your SD-Card reader (or SD-USB adapter if you don't have one). Once every thing is mounted you should get a similar output to the lsblk command : "><meta property="og:title" content="How to reset a forgotten password (Raspberry Pi edition)"><meta property="og:description" content="To do that, simply take the sd card out of your Raspberry Pi and put it in your SD-Card reader (or SD-USB adapter if you don't have one). Once every thing is mounted you should get a similar output to the lsblk command : "><meta property="og:type" content="article"><meta property="og:url" content="https://spyfox.me/posts/cybersecurity/offensive/system/how-to-reset-a-forgotten-password-raspberry-pi-edition/"><meta property="og:image" content="https://spyfox.me/logo.png"><meta property="article:published_time" content="2021-12-05T10:00:00+00:00"><meta property="article:modified_time" content="2021-12-05T10:00:00+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://spyfox.me/logo.png"><meta name=twitter:title content="How to reset a forgotten password (Raspberry Pi edition)"><meta name=twitter:description content="To do that, simply take the sd card out of your Raspberry Pi and put it in your SD-Card reader (or SD-USB adapter if you don't have one). Once every thing is mounted you should get a similar output to the lsblk command : "><meta name=application-name content="~# SpyF0x_"><meta name=apple-mobile-web-app-title content="~# SpyF0x_"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://spyfox.me/posts/cybersecurity/offensive/system/how-to-reset-a-forgotten-password-raspberry-pi-edition/><link rel=prev href=https://spyfox.me/posts/cybersecurity/protection/system/ppa-aur-a-security-hole-in-ubuntu-arch-linux/><link rel=next href=https://spyfox.me/posts/cybersecurity/protection/system/how-to-block-log4j-with-fail2ban/><link rel=stylesheet href=/lib/normalize/normalize.min.css><link rel=stylesheet href=/css/style.min.css><link rel=stylesheet href=/lib/fontawesome-free/all.min.css><link rel=stylesheet href=/lib/animate/animate.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"How to reset a forgotten password (Raspberry Pi edition)","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/spyfox.me\/posts\/cybersecurity\/offensive\/system\/how-to-reset-a-forgotten-password-raspberry-pi-edition\/"},"image":["https:\/\/spyfox.me\/images\/Apple-Devices-Preview.png"],"genre":"posts","keywords":"compromised, hacker, root","wordcount":805,"url":"https:\/\/spyfox.me\/posts\/cybersecurity\/offensive\/system\/how-to-reset-a-forgotten-password-raspberry-pi-edition\/","datePublished":"2021-12-05T10:00:00+00:00","dateModified":"2021-12-05T10:00:00+00:00","publisher":{"@type":"Organization","name":"SpyF0x","logo":"https:\/\/spyfox.me\/images\/avatar.png"},"author":{"@type":"Person","name":" SpyF0x "},"description":"To do that, simply take the sd card out of your Raspberry Pi and put it in your SD-Card reader (or SD-USB adapter if you don't have one). Once every thing is mounted you should get a similar output to the lsblk command : "}</script></head><body header-desktop=fixed header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem('theme')?localStorage.getItem('theme')==='dark':'auto'==='auto'?window.matchMedia('(prefers-color-scheme: dark)').matches:'auto'==='dark')&&document.body.setAttribute('theme','dark')</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="~# SpyF0x_"><img class="lazyload logo" src=/svg/loading.min.svg data-src=/images/avatar.png data-srcset="/images/avatar.png, /images/avatar.png 1.5x, /images/avatar.png 2x" data-sizes=auto alt=/images/avatar.png title=/images/avatar.png>~# SpyF0x_</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>Posts </a><a class=menu-item href=/tags/>Tags </a><a class=menu-item href=/categories/>Categories </a><a class=menu-item href=/posts/about>About </a><a class=menu-item href=/posts/contact><i class="far fa-envelope fa-fw"></i> </a><a class=menu-item href=/index.xml><i class="fas fa-rss fa-fw"></i> </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder="Search titles or contents..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=Search><i class="fas fa-search fa-fw"></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Clear><i class="fas fa-times-circle fa-fw"></i></a>
<span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin"></i></span>
</span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw"></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="~# SpyF0x_"><img class="lazyload logo" src=/svg/loading.min.svg data-src=/images/avatar.png data-srcset="/images/avatar.png, /images/avatar.png 1.5x, /images/avatar.png 2x" data-sizes=auto alt=/images/avatar.png title=/images/avatar.png>~# SpyF0x_</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="Search titles or contents..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=Search><i class="fas fa-search fa-fw"></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Clear><i class="fas fa-times-circle fa-fw"></i></a>
<span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin"></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>Cancel</a></div><a class=menu-item href=/posts/ title>Posts</a><a class=menu-item href=/tags/ title>Tags</a><a class=menu-item href=/categories/ title>Categories</a><a class=menu-item href=/posts/about title>About</a><a class=menu-item href=/posts/contact title><i class="far fa-envelope fa-fw"></i></a><a class=menu-item href=/index.xml title><i class="fas fa-rss fa-fw"></i></a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw"></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animated flipInX">How to reset a forgotten password (Raspberry Pi edition)</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=/ title=Author rel=" author" class=author><i class="fas fa-user-circle fa-fw"></i> SpyF0x </a></span>&nbsp;<span class=post-category>included in <a href=/categories/offensive-security/><i class="far fa-folder fa-fw"></i>Offensive Security</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime=2021-12-05>2021-12-05</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;805 words&nbsp;
<i class="far fa-clock fa-fw"></i>&nbsp;4 minutes&nbsp;</div></div><div class=featured-image><img class=lazyload src=/svg/loading.min.svg data-src=/images/security/raspberry-passw/raspberry-passw0.webp data-srcset="/images/security/raspberry-passw/raspberry-passw0.webp, /images/security/raspberry-passw/raspberry-passw0.webp 1.5x, /images/security/raspberry-passw/raspberry-passw0.webp 2x" data-sizes=auto alt=/images/security/raspberry-passw/raspberry-passw0.webp title="To do that, simply take the sd card out of your Raspberry Pi and put it in your SD-Card reader (or SD-USB adapter if you don't have one). Once every thing is mounted you should get a similar output to the lsblk command : "></div><div class="details toc" id=toc-static kept><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right"></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#a-bit-of-background>A bit of background</a></li><li><a href=#the-idea>The Idea</a></li><li><a href=#tampering-etcshadow>Tampering etc/shadow</a></li><li><a href=#just-to-be-sure>Just to be sure</a></li><li><a href=#make-a-good-action->Make a good action !</a></li></ul></nav></div></div><div class=content id=content><p>So today, we&rsquo;re going to look at how to hack your own Raspberry Pi in order to break any system authentication.</p><h2 id=a-bit-of-background>A bit of background</h2><hr><p>Last week, I wanted to make sure that my favorite device, a proud Raspberry Pi, was secure because there was an important vulnerability on a software I knew was installed on it.</p><p>Happy to open a terminal in order to connect via SSH to this little wonder, my pleasure was interrupted when I saw this :</p><figure><img src=/images/security/raspberry-passw/raspberry-passw1.png alt="denial of service attack"></figure><p>At the time, I thought I must have missed a character, a capital letter, or even a numbers. So I rewrote my password, being sure of what I was writing, and my favorite mini-computer answered me this :</p><figure><img src=/images/security/raspberry-passw/raspberry-passw1.png alt="denial of service attack"></figure><p>Until the famous final third attempt where the server, doing its honest job, happily closes the connection surely thinking that I must be one of those countless brute force bot that roam the internet trying to find some poorly protected computers.</p><p>I have to tell you that I usually just do a global unplugging where I reformat the whole sd card to have a clean image on it again.</p><p>But as this raspberry was, let&rsquo;s say, a rather important part of my home network, reformatting it was simply out of the question.</p><p>So, I had to find an alternative to my usual brutality. Today, I&rsquo;ll show you this miracle solution that saved my weekend.</p><h2 id=the-idea>The Idea</h2><p>There are several authentication schemes that can be used on GNU/Linux systems but the most commonly used and standard scheme is to perform authentication against the <code>/etc/passwd</code> and <code>/etc/shadow</code> files.</p><p>The first one is a plain text-based database that contains information for all user accounts on the system. It is owned by root and has 644 permissions, meaning that the file can only be modified by root or sudo users, but it is readable by all system users.</p><p>The second one, on the other hand, is only accessible by root or sudo users because it contains all the system’s users passwords.</p><p>Don&rsquo;t get too excited, those passwords are heavily encrypted, so don&rsquo;t expect to get your password and guess in the process your whole user&rsquo;s just by looking inside this file !</p><p>Nope, to recover our password, we will simply tamper this file to replace our encrypted password with a temporary known one, that we know the clear version.</p><h2 id=tampering-etcshadow>Tampering etc/shadow</h2><p>To do that, simply take the sd card out of your Raspberry Pi and put it in your SD-Card reader (or SD-USB adapter if you don&rsquo;t have one).</p><p>Once everything is mounted, you should get a similar output to the lsblk command :</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback>$ lsblk 
NAME    MAJ:MIN RM   SIZE RO TYPE  MOUNTPOINTS
sdb       8:16   1   7,4G  0 disk  
├─sdb1    8:17   1   256M  0 part  /media/spyfox/boot
└─sdb2    8:18   1   7,1G  0 part  /media/spyfox/rootfs
</code></pre></td></tr></table></div></div><p>As you can see, we have two partitions on our SD-Card. Head to the Rootfs, you shoud see something like this :</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback>$ cd /media/spyfox/rootfs
bin   dev  home  lost+found  mnt  proc  run   srv  tmp  var
boot  etc  lib   media       opt  root  sbin  sys  usr
</code></pre></td></tr></table></div></div><p>I think we&rsquo;ve unlocked the &ldquo;Linuxception&rdquo; success 🤠</p><figure><img src=/images/security/raspberry-passw/raspberry-passw3.png alt="denial of service attack"></figure><p>Before tampering the <code>shadow</code> file, we will generate a known temporary password only to connect via SSH. Once connected we will reset our password following the standard procedure because by principle I don&rsquo;t trust my computer.</p><p>To do so, I&rsquo;ve searched a lot and I found this solution using Python3 :</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback>python3 -c &#34;from getpass import getpass; from crypt import *; \
    p=getpass(); print(&#39;\n&#39;+crypt(p, METHOD_SHA512)) \
    if p==getpass(&#39;Please repeat: &#39;) else print(&#39;\nFailed repeating.&#39;)&#34;
</code></pre></td></tr></table></div></div><p>This solution has the following benefits:</p><ul><li>Nothing additional to install (Python 3 is widely supported)</li><li>Does not store the password in your shell history.</li><li>Generates a random salt for you.</li><li>Uses a modern, strong hashing algorithm (SHA-512)</li><li>Re-prompts for the password to avoid mistakes.</li></ul><p>The next step is quite simple, because you just need to copy / paste the new hash to the <code>etc/shadow</code> file to override the previous one.</p><p><em>/!\ CHECKPOINT : MAKE SURE YOU ARE EDITING <code>etc/shadow</code> AND NOT <code>/etc/shadow</code> !!!</em></p><p>Once <code>etc/shadow</code> has been properly tampered, just put back the SD-Card in the raspberry, and we are good to go !</p><h2 id=just-to-be-sure>Just to be sure</h2><p>As soon as you are logged back in with your previously blocked user, and you are under total admiration of your SSH banner :</p><figure><img src=/images/security/raspberry-passw/raspberry-passw2.png alt="denial of service attack"></figure><p>You should properly reset your user password with a new one with this simple command :</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback>$ passwd 
</code></pre></td></tr></table></div></div><p>And you should be good !</p><h2 id=make-a-good-action->Make a good action !</h2><hr><p>Hit that <code>CTRL + D</code> to bookmark this website 🔖</p><p>Internet is for sharing, so please consider sharing this post if you liked it !</p><p>It will be so much better than any newsletter #privacy #spam #planet 🌍 ❤️</p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 2021-12-05</span></div><div class=post-info-license></div></div><div class=post-info-line><div class=post-info-md><span><a class=link-to-markdown href=/posts/cybersecurity/offensive/system/how-to-reset-a-forgotten-password-raspberry-pi-edition/index.md target=_blank>Read Markdown</a></span></div><div class=post-info-share><span><a href=javascript:void(0); title="Share on Twitter" data-sharer=twitter data-url=https://spyfox.me/posts/cybersecurity/offensive/system/how-to-reset-a-forgotten-password-raspberry-pi-edition/ data-title="How to reset a forgotten password (Raspberry Pi edition)" data-hashtags=compromised,hacker,root><i class="fab fa-twitter fa-fw"></i></a><a href=javascript:void(0); title="Share on Facebook" data-sharer=facebook data-url=https://spyfox.me/posts/cybersecurity/offensive/system/how-to-reset-a-forgotten-password-raspberry-pi-edition/ data-hashtag=compromised><i class="fab fa-facebook-square fa-fw"></i></a><a href=javascript:void(0); title="Share on Linkedin" data-sharer=linkedin data-url=https://spyfox.me/posts/cybersecurity/offensive/system/how-to-reset-a-forgotten-password-raspberry-pi-edition/><i class="fab fa-linkedin fa-fw"></i></a><a href=javascript:void(0); title="Share on Reddit" data-sharer=reddit data-url=https://spyfox.me/posts/cybersecurity/offensive/system/how-to-reset-a-forgotten-password-raspberry-pi-edition/><i class="fab fa-reddit fa-fw"></i></a><a href=javascript:void(0); title="Share on VK" data-sharer=vk data-url=https://spyfox.me/posts/cybersecurity/offensive/system/how-to-reset-a-forgotten-password-raspberry-pi-edition/ data-title="How to reset a forgotten password (Raspberry Pi edition)" data-caption="To do that, simply take the sd card out of your Raspberry Pi and put it in your SD-Card reader (or SD-USB adapter if you don't have one). Once every thing is mounted you should get a similar output to the lsblk command : " data-image=/images/security/raspberry-passw/raspberry-passw0.webp><i class="fab fa-vk fa-fw"></i></a><a href=javascript:void(0); title="Share on Pocket" data-sharer=pocket data-url=https://spyfox.me/posts/cybersecurity/offensive/system/how-to-reset-a-forgotten-password-raspberry-pi-edition/><i class="fab fa-get-pocket fa-fw"></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw"></i>&nbsp;<a href=/tags/compromised/>compromised</a>,&nbsp;<a href=/tags/hacker/>hacker</a>,&nbsp;<a href=/tags/root/>root</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class=post-nav><a href=/posts/cybersecurity/protection/system/ppa-aur-a-security-hole-in-ubuntu-arch-linux/ class=prev rel=prev title="PPA & AUR : A security hole in Ubuntu & Arch Linux ?"><i class="fas fa-angle-left fa-fw"></i>PPA & AUR : A security hole in Ubuntu & Arch Linux ?</a>
<a href=/posts/cybersecurity/protection/system/how-to-block-log4j-with-fail2ban/ class=next rel=next title="How to block Log4j with fail2ban">How to block Log4j with fail2ban<i class="fas fa-angle-right fa-fw"></i></a></div></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line><i class="far fa-copyright fa-fw"></i><span itemprop=copyrightYear>2019 - 2022</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/ target=_blank> SpyF0x </a></span>&nbsp;|&nbsp;<span class=license><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc-nd/4.0/ target=_blank>CC BY-NC-ND 4.0</a></span><span class=icp-splitter>&nbsp;|&nbsp;</span><br class=icp-br><span class=icp><a href=/posts/disclaimer>Disclaimer</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw"></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw"></i></a></div><script type=text/javascript src=/lib/smooth-scroll/smooth-scroll.min.js></script><script type=text/javascript src=/lib/autocomplete/autocomplete.min.js></script><script type=text/javascript src=/lib/lunr/lunr.min.js></script><script type=text/javascript src=/lib/lazysizes/lazysizes.min.js></script><script type=text/javascript src=/lib/clipboard/clipboard.min.js></script><script type=text/javascript src=/lib/sharer/sharer.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:50},comment:{},search:{highlightTag:"em",lunrIndexURL:"/index.json",maxResultLength:10,noResultsFound:"No results found",snippetLength:30,type:"lunr"}}</script><script type=text/javascript src=/js/theme.min.js></script></body></html>